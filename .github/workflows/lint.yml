name: Code Quality - Linting

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]
  workflow_dispatch:  # Allow manual triggering

jobs:
  lint:
    name: Run Linters
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v6
      
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
        
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install flake8 black
        
    - name: Check code formatting with Black
      run: |
        black --check --diff src/ tests/ || echo "Note: Black formatting check failed. Run 'black src/ tests/' to fix."
        
    - name: Run Flake8 linter
      run: |
        # Run flake8 with max line length 88 (matching Black)
        flake8 src/ tests/ --count --max-complexity=10 --max-line-length=88 --statistics
        
    - name: Check for syntax errors
      run: |
        python -m py_compile src/*.py tests/*.py || true
